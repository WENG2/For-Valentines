<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Little Surprise ‚ù§Ô∏è</title>

<style>
body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: linear-gradient(to bottom right, #ffe6f0, #fff5e6);
    margin: 0;
    padding: 0;
}

h1, h2 {
    color: #d63384;
}

#envelope-screen {
    margin-top: 100px;
}

#envelope {
    font-size: 80px;
    cursor: pointer;
    transition: transform 0.3s ease;
}

#envelope:hover {
    transform: scale(1.1);
}

#puzzle-container {
    display: none;
    margin-top: 30px;
}

.grid {
    width: 300px;
    height: 300px;
    margin: auto;
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    gap: 2px;
}

.tile {
    width: 100%;
    height: 100%;
    cursor: pointer;
}

.hidden {
    visibility: hidden;
}

button {
    padding: 10px 20px;
    font-size: 18px;
    background-color: #ff4d6d;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    margin-top: 20px;
}

button:hover {
    background-color: #e63950;
}

#final-screen {
    display: none;
    margin-top: 30px;
}

#completed-image {
    width: 300px;
    border-radius: 15px;
    margin-top: 20px;
}

</style>
</head>

<body>

<div id="envelope-screen">
    <h1>Kerwin has something for you üíå</h1>
    <div id="envelope">üíå</div>
    <p>Click the envelope to open...</p>
</div>

<div id="puzzle-container">
    <h2>Put our memory back together ‚ù§Ô∏è</h2>
    <div class="grid" id="grid"></div>
</div>

<div id="final-screen">
    <h2>You solved it‚Ä¶ but you already solved my heart the day we met ‚ù§Ô∏è</h2>
    <h1>Will you be my Valentine, always?</h1>
    <button onclick="celebrate()">Yes ‚ù§Ô∏è</button>
    <br>
    <img id="completed-image" src="images/full-image.png">
</div>

<script>

const tiles = [
    "images/tile-1.png",
    "images/tile-2.png",
    "images/tile-3.png",
    "images/tile-4.png",
    "images/tile-5.png",
    "images/tile-6.png",
    "images/tile-7.png",
    "images/tile-8.png",
    "images/tile-9.png"
];

let currentOrder = [...tiles];
let emptyIndex = 8; // last tile is empty

const grid = document.getElementById("grid");

document.getElementById("envelope").onclick = function() {
    document.getElementById("envelope-screen").style.display = "none";
    document.getElementById("puzzle-container").style.display = "block";
    initPuzzle();
}

function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

function initPuzzle() {
    currentOrder = [...tiles];
    shuffle(currentOrder);
    render();
}

function render() {
    grid.innerHTML = "";
    currentOrder.forEach((tile, index) => {
        const img = document.createElement("img");
        img.src = tile;
        img.className = "tile";

        if (tile === "images/tile-9.png") {
            img.classList.add("hidden");
            emptyIndex = index;
        }

        img.onclick = () => moveTile(index);
        grid.appendChild(img);
    });
}

function moveTile(index) {
    const validMoves = [
        emptyIndex - 1,
        emptyIndex + 1,
        emptyIndex - 3,
        emptyIndex + 3
    ];

    if (validMoves.includes(index)) {
        [currentOrder[index], currentOrder[emptyIndex]] =
        [currentOrder[emptyIndex], currentOrder[index]];

        emptyIndex = index;
        render();
        checkWin();
    }
}

function checkWin() {
    for (let i = 0; i < tiles.length; i++) {
        if (currentOrder[i] !== tiles[i]) {
            return;
        }
    }

    document.getElementById("puzzle-container").style.display = "none";
    document.getElementById("final-screen").style.display = "block";
}

function celebrate() {
    alert("YAY!!! ‚ù§Ô∏è Happy Valentine's Day!!! I love you ‚ù§Ô∏è");
}

</script>

</body>
</html>
